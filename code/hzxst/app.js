angular.module("mobile").config(["$locationProvider","$stateProvider","$urlRouterProvider","$httpProvider",function(e,o,t,i){o.state("login",{url:"/",views:{main:{templateUrl:"views/login/login.html",controller:"LoginCtrl"}}})}]).controller("LoginCtrl",["$ionicPlatform","$cordovaDevice","$location","$rootScope","$scope","$state","$ionicViewSwitcher","$ionicHistory","$ionicModal","LoginService","$interval","$timeout","userService","jpushService","messageService","VersionService","$ionicLoading","$ionicPopup","$cordovaFileTransfer","$cordovaFileOpener2","appUpdateService",function(e,o,t,i,n,r,a,c,s,l,d,u,m,f,p,h,g,v,w,b,S){n.showpage=0,n.setFocus={isFocus:!1},void 0===n.data&&(n.data={mobile_num:"",code_num:""}),e.ready(function(){function e(){h.get({platform:ionic.Platform.platform()},function(o){"000"==o.code?1==o.data.isforce&&parseFloat(window.appversion)<parseFloat(o.data.version)?(n.isFocusUpload=!0,ionic.Platform.isAndroid()&&S.showUpdateConfirm(o.data),ionic.Platform.isIOS()&&v.alert({title:"版本升级",template:o.data.upgradeinfo,okText:"升级"}).then(function(t){"cordova"in window&&cordova.InAppBrowser.open(o.data.url,"_blank","location=no"),u(function(){e()},2e3)})):n.isFocusUpload=!1:p.show(o.msg)})}void 0===n.data&&(n.data={mobile_num:"",code_num:""}),window.device?(n.data.devicemodel=o.getModel(),n.data.deviceuuid=o.getUUID(),n.data.platform=o.getPlatform(),window.plugins&&window.plugins.screensize?window.plugins.screensize.get(function(e){n.data.phisicalsize=e.diameter},function(e){n.data.phisicalsize="0"}):p.show("获取屏幕尺寸失败!")):(n.data.devicemodel="pctest",n.data.deviceuuid="E754B1E0-119A-452C-B3D9-F920689AF77B",n.data.platform="IOS",n.data.phisicalsize=5.6),e(),n.$watch("isFocusUpload",function(e){0==e&&(localStorage.getItem("token")?(r.go("home.index"),m.get({ACTION:"ONE"},function(e){"000"==e.code?(i.userInfo={profilepicture:e.data.profilepicture,username:e.data.username,mobile:e.data.mobile,fullname:e.data.fullname},f.setAlias(i.userInfo.mobile+"")):p.show(e.msg)})):n.showpage=1)})}),n.$watch("data.mobile_num + data.code_num",function(){n.data.mobile=n.data.mobile_num&&n.data.mobile_num.toString(),n.data.code=n.data.code_num&&n.data.code_num.toString()}),n.count=0,n.sendcodeText="发送验证码",n.getValidCode=function(){n.count>0?p.show("验证码接收过于频繁，请稍后再试"):n.data.mobile&&11==n.data.mobile.length?(n.count=59,n.sendcodeText=n.count+"s后重发",n.timerHandler=d(function(){n.count<=0?(d.cancel(n.timerHandler),n.sendcodeText="发送验证码"):(n.sendcodeText=n.count+"s后重发",n.count--),$("#validbtn").text(n.sendcodeText)},1e3),l.get(n.data,function(e){n.setFocus.isFocus=!0,"000"!=e.code&&(n.count=0,d.cancel(n.timerHandler),n.sendcodeText="发送验证码",$("#validbtn").text(n.sendcodeText),p.show(e.msg))})):p.show("请输入11位的手机号码")},n.login=function(e){n.data.mobile&&11==n.data.mobile.length?n.data.code&&4==n.data.code.length?(c.clearHistory(),c.clearCache(),a.nextDirection("exit"),n.resperror="",l.save(n.data,function(e){"000"==e.code?(localStorage.setItem("token",e.data.token),localStorage.setItem("groupid",e.data.groupid),f.setAlias(n.data.mobile_num+""),r.go("home.index",{code:""})):p.show(e.msg)})):p.show("请输入收到的4位短信验证码"):p.show("请输入11位的手机号码")},n.loginHelp=function(){n.openModal()},s.fromTemplateUrl("views/login/login-recommend.html",{scope:n,animation:"slide-in-up"}).then(function(e){n.modal=e}),n.openModal=function(){n.modal.show()},n.closeModal=function(){n.modal.hide()},n.$on("$destroy",function(){n.modal&&n.modal.remove()}),n.$on("modal.hidden",function(){}),n.$on("modal.removed",function(){})}]),angular.module("mobile").controller("HomeCtrl",["$ionicPlatform","$cordovaDevice","$location","$rootScope","$scope","$state","$ionicViewSwitcher","$ionicTabsDelegate","$ionicHistory","PageService","CourseInfoService","StudyService","$interval","$timeout","$ionicLoading","$ionicScrollDelegate","$stateParams","$ionicPopup","messageService","NoticeService",function(e,o,t,i,n,r,a,c,s,l,d,u,m,f,p,h,g,v,w,b){function S(){n.pageCode=g.code||"",i.isHomePage=1,n.CourseProgress=[],n.CourseProgressDone=0,n.loading=1;var o;if(o=""==n.pageCode?{ACTION:"QUERY",category:1}:{code:n.pageCode},l.get(o,function(e){"000"==e.code?e.data&&(n.page=$.isArray(e.data)?e.data[0]:e.data,n.page&&n.page.config&&(n.UIList2=JSON.parse(n.page.config),JSON.stringify(n.UIList).replace(/,\s*"\$\$hashKey"\:\s*"object\:\s*\d+"/g,"")!=JSON.stringify(n.UIList2)&&(n.UIList=n.UIList2))):w.show(e.msg),f(function(){n.loading=0},400)}),b.get({ACTION:"UNREAD"},function(e){"000"==e.code?n.hasNotices=parseInt(e.data.count)>0:w.show(e.msg)}),ionic.Platform.isAndroid()){n.homebackregister=e.registerBackButtonAction(function(e){if("home.index"==r.$current.name)return i.backcount=i.backcount||0,i.backcount++,2==i.backcount&&v.confirm({title:"<strong>退出应用?</strong>",template:"你确定要退出吗?",okText:"退出",cancelText:"取消"}).then(function(e){e?ionic.Platform.exitApp():i.backcount=0}),e.preventDefault(),!1;navigator.app.backHistory()},101),n.$on("$ionicParentView.leave",function(){n.homebackregister&&n.homebackregister()});var t=n.$watch("loading",function(e,o,i){e?n.showLoading():(n.hideLoading(),t())})}}n.hasNotices=!1,n.$on("$ionicView.beforeEnter",function(e,o){c.showBar(!0),S()}),n.UIList=[],n.clickInread=function(){n.$broadcast("mytab.selectInread",{})},n.showLoading=function(){p.show({template:'<img width="18px" height="18px" src="img/loading.gif">&nbsp;&nbsp;<span style="vertical-align:super;">请稍等...</span>'}).then(function(){f(function(){p._getLoader().$$state.value.isShown&&p.show({template:'<span style="vertical-align:super;">请求超时</span>',duration:1e3})},3e4)})},n.hideLoading=function(){p.hide().then(function(){})}}]).config(["$locationProvider","$stateProvider","$urlRouterProvider","$httpProvider",function(e,o,t,i){o.state("home",{url:"/home",views:{main:{abstract:!0,templateUrl:"views/home/home.html"}}}).state("home.index",{url:"/index",views:{"tab-index":{templateUrl:"views/home/home-index.html",controller:"HomeCtrl"}}})}]),angular.module("mobile").controller("TopicCtrl",["$ionicPlatform","$cordovaDevice","$location","$rootScope","$scope","$state","$ionicViewSwitcher","$ionicTabsDelegate","$ionicHistory","PageService","CourseInfoService","StudyService","$interval","$timeout","$ionicLoading","$ionicScrollDelegate","$stateParams","$ionicPopup","messageService",function(e,o,t,i,n,r,a,c,s,l,d,u,m,f,p,h,g,v,w){function b(){n.pageCode=g.code||"",i.isHomePage=1,n.CourseProgress=[],n.CourseProgressDone=0,n.loading=1;var e;e=""==n.pageCode?{ACTION:"QUERY",category:1}:{code:n.pageCode},l.get(e,function(e){"000"==e.code?e.data&&(n.page=$.isArray(e.data)?e.data[0]:e.data,n.page&&n.page.config&&(n.UIList2=JSON.parse(n.page.config),JSON.stringify(n.UIList).replace(/,\s*"\$\$hashKey"\:\s*"object\:\s*\d+"/g,"")!=JSON.stringify(n.UIList2)&&(n.UIList=n.UIList2))):w.show(e.msg),f(function(){n.loading=0},400)})}n.$on("$ionicView.beforeEnter",function(e,o){c.showBar(!1),b()}),n.UIList=[]}]).config(["$locationProvider","$stateProvider","$urlRouterProvider","$httpProvider",function(e,o,t,i){o.state("home.index-topic",{url:"/topic/code/:code",views:{"tab-index":{templateUrl:"views/topic/topic.html",controller:"TopicCtrl"}}}).state("home.inread-topic",{url:"/topic/code/:code",views:{"tab-inread":{templateUrl:"views/topic/topic.html",controller:"TopicCtrl"}}})}]),function(){angular.module("mobile").config(["$locationProvider","$stateProvider","$urlRouterProvider","$httpProvider",function(e,o,t,i){o.state("home.inread",{url:"/inread",params:{index:null},views:{"tab-inread":{templateUrl:"views/inread/inread.html",controller:"inreadController"}}})}]).controller("inreadController",["$location","$rootScope","$scope","$state","$stateParams","inreadService","$ionicViewSwitcher","$ionicTabsDelegate","$ionicHistory","$timeout","$ionicTabsDelegate",function(e,o,t,i,n,r,a,c,s,l,c){t.$on("$ionicSlides.sliderInitialized",function(e,i){t.slider=i.slider,t.edit_text="编辑",1==o.skipToCache&&(t.slider.slideTo(2),o.skipToCache=!1)}),t.$on("$ionicSlides.slideChangeStart",function(e,i){t.edit_text="编辑",t.$broadcast("inread.slideChangeStart",i.slider.activeIndex),o.$$phase||t.$digest()}),t.clickTab=function(e){l(function(){t.slider.slideTo(e)})},t.$on("videoDetail.skipToCache",function(e,o){t.clickTab(2)}),t.edit=function(e){1==(e=t.slider.activeIndex)&&t.$broadcast("inread.editVideoCollect"),2==e&&t.$broadcast("inread.editLocalCache"),"编辑"==t.edit_text?t.edit_text="完成":t.edit_text="编辑"},t.$on("$ionicView.beforeEnter",function(e,i){c.showBar(!0),t.edit_text="编辑",1==o.skipToCache&&t.slider&&(t.slider.slideTo(2),o.skipToCache=!1),t.slider&&t.$broadcast("inread.slideChangeStart",t.slider.activeIndex)}),t.$on("video.hidden",function(e,o){t.slider&&t.$broadcast("inread.slideChangeStart",t.slider.activeIndex)})}]).factory("inreadService",["$resource",function(e){return e("/inread/")}])}(),function(){angular.module("mobile").config(["$locationProvider","$stateProvider","$urlRouterProvider","$httpProvider",function(e,o,t,i){o.state("home.usercenter",{url:"/user-center",views:{"tab-usercenter":{templateUrl:"views/user-center/user-center.html",controller:"userCenterController"}}})}]).controller("userCenterController",["$location","$rootScope","$scope","$state","myPartnerService","$ionicTabsDelegate","$ionicPopup","userService","messageService","LoginService","VersionService","appUpdateService","$sce",function(e,o,t,i,n,r,a,c,s,l,d,u,m){t.hasNewVersion=0,t.my_items=[{function_name:"",name:"我的合伙人",icon:"img/my-partner@2x.png",status:"",click:"myPartner"}],t.device_items=[{function_name:"binding-device",name:"绑定设备",icon:"img/device@3x.png",status:""},{function_name:"",name:"常见问题",icon:"img/question@3x.png",status:"",click:"oftenIssue"},{function_name:"",name:"联系客服",icon:"img/contact@3x.png",status:"",click:"contactCustomer"}],t.init=function(){c.get({ACTION:"ONE"},function(e){"000"==e.code&&(o.userInfo={profilepicture:e.data.profilepicture,username:e.data.username,mobile:e.data.mobile,fullname:e.data.fullname})}),t.appUpdateCheck(1)},t.$on("$ionicView.beforeEnter",function(){r.showBar(!0),t.init()}),t.logout=function(){localStorage.removeItem("token"),localStorage.removeItem("groupid"),window.location.href=""},t.showConfirm=function(){a.confirm({template:'<div><label>确认拨打电话：400-518-1120</label></div><div style="margin: 5px 0; background: #bbbbbb; border-color: #191616; border-width: 0; height: 1px; "></div>',cancelText:"取消",okText:"确认"}).then(function(e){})},t.itemClick=function(e){if(e)switch(e){case"myPartner":t.clickMyPartner();break;case"contactCustomer":i.go("home.third-page",{category:"contact-customer",title:"联系客服"});break;case"oftenIssue":i.go("home.third-page",{category:"often-issue",title:"常见问题"});break;case"appUpdateCheck":t.appUpdateCheck()}},t.appUpdateCheck=function(e){d.get({platform:ionic.Platform.platform()},function(e){if("000"==e.code){if(parseFloat(window.appversion)>=parseFloat(e.data.version))return;if(t.hasNewVersion=1,"1"==e.data.isforce&&(window.location.href=""),"haveCancelUpload"in window&&1==window.haveCancelUpload)return;u.showUpdateConfirm(e.data)}else s.show(e.msg)})},t.showAlert=function(){a.alert({buttons:[{text:"确定",type:"button-assertive"}],template:"您的合伙人申请正在审核中，请耐心等待！"}).then(function(e){})},t.clickMyPartner=function(){n.get({ACTION:"SUMMARY"},function(e){switch(e.code){case"010":i.go("home.activate-my-partner");break;case"001":a.alert({buttons:[{text:"确定",type:"button-assertive"}],template:"您的合伙人申请正在审核中，请耐心等待！"});break;case"000":i.go("home.my-partner");break;case"002":i.go("home.activate-my-partner");break;case"003":a.alert({buttons:[{text:"确定",type:"button-assertive"}],template:"您的合伙人资质已被冻结！"})}},function(e){s.show(e)})},t.editUser=function(){i.go("home.modify-user")}}])}(),function(){angular.module("mobile").config(["$locationProvider","$stateProvider","$urlRouterProvider","$httpProvider",function(e,o,t,i){o.state("home.my-partner",{url:"/my-partner",views:{"tab-usercenter":{templateUrl:"views/my-partner/my-partner.html",controller:"myPartnerController"}}})}]).controller("myPartnerController",["$location","$rootScope","$scope","$state","myPartnerService","$ionicTabsDelegate","$ionicHistory","$timeout","messageService","$ionicViewSwitcher",function(e,o,t,i,n,r,a,c,s,l){t.$on("$ionicSlides.sliderInitialized",function(e,i){t.slider=i.slider,1==o.skipToMember&&(t.slider.slideTo(1),o.skipToMember=!1)}),t.$on("$ionicView.beforeEnter",function(e){r.showBar(!1),t.init(),o.$broadcast("my-partner.enter"),t.slider&&1==o.skipToMember&&(t.slider.slideTo(1),o.skipToMember=!1)}),t.$on("$ionicView.beforeLeave",function(e){o.$broadcast("my-partner.leave")}),t.earnings="10025.10",t.name="帅哥一枚",t.options={loop:!1,pagination:!1},t.clickTab=function(e){c(function(){t.slider.slideTo(e)})},t.$on("$ionicSlides.slideChangeStart",function(e,o){t.$digest()}),t.init=function(){n.get({ACTION:"SUMMARY"},function(e){"000"==e.code?t.group_member_count=e.data.group_member_count:(s.show(e.msg),c(function(){l.nextDirection("back"),a.goBack()},1e3))},function(e){})}}]).directive("adaptWindow",["$timeout",function(e){return{restrict:"A",link:function(o,t,i){e(function(){t.css({position:"absolute",bottom:0,left:0,right:0,top:t.prev().height()})})}}}])}(),function(){angular.module("mobile").config(["$locationProvider","$stateProvider","$urlRouterProvider","$httpProvider",function(e,o,t,i){o.state("home.activate-my-partner",{url:"/activate-my-partner",views:{"tab-usercenter":{templateUrl:"views/activate-my-partner/activate-my-partner.html",controller:"activateMyPartnerController"}}})}]).controller("activateMyPartnerController",["$location","$rootScope","$scope","$state","$ionicTabsDelegate","$ionicHistory","$ionicModal",function(e,o,t,i,n,r,a){n.showBar(!1),t.show=function(){o.hideTabs=!o.hideTabs},t.$on("$ionicView.enter",function(e){var o=r.viewHistory();angular.forEach(o.views,function(e,o){}),angular.forEach(o.histories[r.currentHistoryId()].stack,function(e,o){})}),t.check=function(){t.isChecked=!t.isChecked},a.fromTemplateUrl("views/activate-my-partner/agreement.html",{scope:t,animation:"slide-in-up"}).then(function(e){t.modal=e}),t.openModal=function(){t.modal.show()},t.closeModal=function(){t.modal.hide()},t.$on("$destroy",function(){t.modal.remove()}),t.openAgreement=function(){$.ajax({url:"https://service.huizeguoxue.com/service/applesson/dictionary",type:"get",data:{k:"guoxue-content-spread-agreement",t:(new Date).getTime()}}).then(function(e){e.data.v&&""!=e.data.v&&(t.openModal(),$("#agreement").html(e.data.v))})}}])}(),function(){angular.module("mobile").config(["$locationProvider","$stateProvider","$urlRouterProvider","$httpProvider",function(e,o,t,i){o.state("home.activate-my-partner-info",{url:"/activate-my-partner-info",views:{"tab-usercenter":{templateUrl:"views/activate-my-partner-info/activate-my-partner-info.html",controller:"activateMyPartnerInfoController"}}})}]).controller("activateMyPartnerInfoController",["$location","$rootScope","$scope","$state","myPartnerService","uploadFileService","$ionicActionSheet","messageService","$ionicHistory",function(e,o,t,i,n,r,a,c,s){function l(){t.data.id_card_url="result.data.url",r.upload({allowEdit:!0},"UP-ID-CARD",1,function(e){if(200==e.responseCode){var o=JSON.parse(e.response);"000"==o.code&&(t.data.id_card_url=o.data.url)}},function(e){},function(e){})}function d(){r.upload({},"UP-ID-CARD",0,function(e){if(200==e.responseCode){var o=JSON.parse(e.response);"000"==o.code&&(t.data.id_card_url=o.data.url)}},function(e){},function(e){})}t.data={wechat:"",fullname:"",identity_card:"",id_card_url:""},t.save=function(){18==t.data.identity_card.length?n.save(t.data,function(e){"000"==e.code?(s.backView()&&"home.activate-my-partner"==s.backView().stateName&&s.removeBackView(),s.goBack()):c.show(e.msg)}):c.show("身份证号码长度为18位!")},t.uploadFile=function(){a.show({buttons:[{text:"拍摄"},{text:"相册"}],cancelText:"取消",cancel:function(){},buttonClicked:function(e){switch(e){case 0:l();break;case 1:d()}return!0}})}}])}(),function(){angular.module("mobile").config(["$locationProvider","$stateProvider","$urlRouterProvider","$httpProvider",function(e,o,t,i){o.state("home.my-bussiness-card",{url:"/my-bussiness-card",views:{"tab-usercenter":{templateUrl:"views/my-bussiness-card/my-bussiness-card.html",controller:"myBussinessCardController"}}})}]).controller("myBussinessCardController",["$location","$rootScope","$scope","$state","myBussinessCardService","$ionicModal","wechatService",function(e,o,t,i,n,r,a){t.src=window.HOST+"service/applesson/spread?ACTION=IMG&groupid="+localStorage.getItem("groupid")+"&t="+Date.parse(new Date),t.share=function(){var e={title:"我是"+o.userInfo.fullname+",我为孩子改变",description:"俗话说“三岁看大，七岁看老”。教育慎始，开始的方向决定了人生的方向。",thumb:o.userInfo.profilepicture||window.BUY_SITE+"img/default-icon.png",media:{image:t.src}};a.open(e)}}]).factory("myBussinessCardService",["$resource",function(e){return e("/my-bussiness-card/")}])}(),function(){angular.module("mobile").factory("wechatService",["$resource","$ionicModal","$rootScope","wechatShareService",function(e,o,t,i){function n(){r.message={},r.modal.hide()}var r=t.$new(!0);o.fromTemplateUrl("views/my-bussiness-card/wechat-demo.html",{scope:r,animation:"slide-in-up",name:"share"}).then(function(e){r.modal=e}),r.clickBackground=function(e){"ION-MODAL-VIEW"==e.target.tagName&&n()},r.$on("$destroy",function(){r.modal&&r.modal.remove()}),r.$on("modal.hidden",function(){}),r.$on("modal.removed",function(){});return r.share=function(e){i.share(e,"send-photo-remote",r.message),n()},{open:function(e){r.message=e||{},r.modal.show()},close:n}}])}(),function(){angular.module("mobile").component("teamMember",{templateUrl:"views/team-member/team-member.html",controller:["$location","$rootScope","$scope","$state","myPartnerService","$timeout","$ionicScrollDelegate","messageService",function(e,o,t,i,n,r,a,c){t.members=[],t.pageindex=0,t.pagesize=10,t.loading=!1,t.noMoreRecord=!0,t.loadMore=function(){t.loading=!0,n.get({ACTION:"MEMBERS",pageindex:t.pageindex,pagesize:t.pagesize},function(e){"000"==e.code?(e.data.members.length<t.pagesize?t.noMoreRecord=!0:t.noMoreRecord=!1,0==t.pageindex?t.members=e.data.members:t.members=t.members.concat(e.data.members),t.pageindex+=1):c.show(e.msg),t.$broadcast("scroll.infiniteScrollComplete"),t.loading=!1},function(e){t.noMoreRecord=!0,t.loading=!1,t.$broadcast("scroll.infiniteScrollComplete")})},t.$on("my-partner.enter",function(){t.members=[],t.pageindex=0,t.pagesize=10,t.loadMore()}),t.$on("my-partner.leave",function(){a.$getByHandle("team-member").scrollTop(),r(function(){t.members=[],t.noMoreRecord=!0},300)}),t.loadMore()}]})}(),function(){angular.module("mobile").component("myBonus",{templateUrl:"views/my-bonus/my-bonus.html",controller:["$location","$rootScope","$scope","$state","myPartnerService","$ionicTabsDelegate",function(e,o,t,i,n,r,a){t.clickWithdraw=function(){n.get({ACTION:"SUMMARY"},function(e){"000"==e.code?1==e.data.group_is_bind_bank?i.go("home.withdraw"):i.go("home.bind-card"):a.show(e.msg)},function(e){})},t.clickWithdrawRecord=function(){i.go("home.withdraw-detail")},t.init=function(){n.get({ACTION:"SUMMARY"},function(e){t.data=e.data},function(e){})},t.$on("my-partner.enter",function(){t.init()}),t.init()}]})}(),function(){angular.module("mobile").config(["$locationProvider","$stateProvider","$urlRouterProvider","$httpProvider",function(e,o,t,i){o.state("home.bonus-detail",{url:"/bonus-detail",params:{type:null},views:{"tab-usercenter":{templateUrl:"views/bonus-detail/bonus-detail.html",controller:"bonusDetailController"}}})}]).controller("bonusDetailController",["$location","$rootScope","$scope","$state","myPartnerService","$stateParams","messageService",function(e,o,t,i,n,r,a){for(var c=[{text:"所有年份",value:""}],s=2017;s<=(new Date).getFullYear();s++)c.push({text:s,value:s});$("[name=bonusDetail] [name=year]").mobiscroll().select({theme:"ios",lang:"zh",cancelText:"取消",setText:"确定",display:"bottom",minWidth:200,group:!1,data:c,onSelect:function(e,o){t.params.year=o.getVal(),""==t.params.year&&(t.params.month="")},onInit:function(e){t.$watch("params.year",function(o){e.setVal(o,!0)})}});for(var l=[{text:"所有月份",value:""}],d=1;d<=12;d++)l.push({text:d,value:d});$("[name=bonusDetail] [name=month]").mobiscroll().select({theme:"ios",lang:"zh",cancelText:"取消",setText:"确定",display:"bottom",minWidth:200,group:!1,data:l,onSelect:function(e,o){t.params.month=o.getVal(),t.$apply()},onBeforeShow:function(e){if(""==t.params.year)return a.show("请先选择年份"),!1},onInit:function(e){t.$watch("params.month",function(o){window.testObj=e,e.setVal(o,!0)})}}),t.loadMore=function(){t.loading=!0;var e={ACTION:r.type,pageindex:t.pageindex,pagesize:t.pagesize,year:t.params.year,month:t.params.month};n.get(e,function(e){"000"==e.code&&(t.$broadcast("scroll.infiniteScrollComplete"),e.data.list.length<t.pagesize&&(t.noMoreRecord=!0),t.pageindex+=1,t.bonus_details=t.bonus_details.concat(e.data.list)),t.loading=!1},function(e){t.noMoreRecord=!0,t.loading=!1,t.$broadcast("scroll.infiniteScrollComplete")})},t.filter=function(){t.bonus_details=[],t.pageindex=0,t.pagesize=10,t.loading=!0,t.noMoreRecord=!1},t.$on("$ionicView.beforeEnter",function(){r.type&&"DETAIL-MONTH-PROFIT"==r.type?t.params={year:(new Date).getFullYear(),month:(new Date).getMonth()+1}:t.params={year:"",month:""},t.bonus_details=[],t.pageindex=0,t.pagesize=10,t.loading=!1,t.noMoreRecord=!1})}])}(),function(){angular.module("mobile").config(["$locationProvider","$stateProvider","$urlRouterProvider","$httpProvider",function(e,o,t,i){o.state("home.binding-device",{url:"/binding-device",views:{"tab-usercenter":{templateUrl:"views/binding-device/binding-device.html",controller:"bindingDeviceController"}}})}]).controller("bindingDeviceController",["$location","$rootScope","$scope","$state","userService","$ionicTabsDelegate","messageService",function(e,o,t,i,n,r,a){t.devices=[],n.get({ACTION:"DEVICE"},function(e){"000"==e.code?t.devices=e.data.list:a.show(e.msg)}),r.showBar(!1)}])}(),function(){angular.module("mobile").config(["$locationProvider","$stateProvider","$urlRouterProvider","$httpProvider",function(e,o,t,i){o.state("home.binding-device-detail",{url:"/binding-device-detail/:id",param:{id:null},views:{"tab-usercenter":{templateUrl:"views/binding-device-detail/binding-device-detail.html",controller:"bindingDeviceDetailController"}}})}]).controller("bindingDeviceDetailController",["$location","$rootScope","$scope","$state","userService","$ionicHistory","$stateParams","LoginService","messageService",function(e,o,t,i,n,r,a,c,s){t.info={name:"iphone7"},t.unbind=function(){c.delete({id:a.id},function(e){"000"==e.code?(localStorage.removeItem("token"),localStorage.removeItem("groupid"),window.location.href=""):s.show(e.msg)})},n.get({ACTION:"DEVICE"},function(e){"000"==e.code?angular.forEach(e.data.list,function(e){e.id==a.id&&(t.info=e,t.info.deviceuuid=t.info.deviceuuid.replace(/-/g,"").substring(0,10))}):s.show(e.msg)})}])}(),function(){angular.module("mobile").config(["$locationProvider","$stateProvider","$urlRouterProvider","$httpProvider",function(e,o,t,i){o.state("home.systemnotice",{url:"/system-notice",views:{"tab-usercenter":{templateUrl:"views/system-notice/system-notice.html",controller:"systemNoticeController"}}})}]).controller("systemNoticeController",["$location","$rootScope","$scope","$state","systemNoticeService","$ionicTabsDelegate",function(e,o,t,i,n,r){r.showBar(!1),t.items=[{title:"银行卡绑定失败",description:"抱歉，你的银行卡绑定失败，由于一下原因：银行卡xxxxxxxxxxxxxxxxx"},{title:"你有一笔新增的收入",description:"你的下级 称现身招揽了1名客户，你获得了￥10.12的现金奖励。请注意查收"},{title:"银行卡绑定失败",description:"抱歉，你的银行卡绑定失败，由于一下原因：银行卡xxxxxxxxxxxxxxxxx"},{title:"银行卡绑定失败",description:"抱歉，你的银行卡绑定失败，由于一下原因：银行卡xxxxxxxxxxxxxxxxx"},{title:"银行卡绑定失败",description:"抱歉，你的银行卡绑定失败，由于一下原因：银行卡xxxxxxxxxxxxxxxxx"},{title:"银行卡绑定失败",description:"抱歉，你的银行卡绑定失败，由于一下原因：银行卡xxxxxxxxxxxxxxxxx"}]}]).factory("systemNoticeService",["$resource",function(e){return e("/system-notice/")}])}(),function(){angular.module("mobile").component("studyRecord",{templateUrl:"views/study-record/study-record.html",controller:["$location","$rootScope","$scope","$state","StudyService",function(e,o,t,i,n){t.getRecords=function(){n.get({ACTION:"LOG"},function(e){"000"==e.code&&(t.items=e.data.studylog,t.$broadcast("scroll.refreshComplete"))})},t.getRecords(),t.doRefresh=function(){t.getRecords()},t.openVideo=function(e){o.video.code=e,o.openVideo()},t.$on("inread.slideChangeStart",function(e,o){void 0!==o&&0==o&&t.getRecords()})}]}).factory("studyRecordService",["$resource",function(e){return e("/study-record/")}])}(),function(){angular.module("mobile").component("videoCollect",{templateUrl:"views/video-collect/video-collect.html",controller:["$location","$rootScope","$scope","$state","LessonFavouriteService","messageService","$timeout",function(e,o,t,i,n,r,a){t.getRecords=function(){n.query({},function(e){"000"==e.code?(t.items=e.data.favourites,t.$broadcast("scroll.refreshComplete")):r.show(e.msg)})},t.getRecords(),t.doRefresh=function(){t.getRecords()},t.$on("inread.editVideoCollect",function(){t.shouldShowDelete1=!t.shouldShowDelete1,t.deleteItems()}),t.$on("inread.slideChangeStart",function(e,o){if(o&&1==o)t.shouldShowDelete1=!1,t.getRecords();else for(var i=0;i<t.items.length;i++)t.items[i].delete&&(delete t.items[i].delete,$(".collect ion-delete-button").css("color","#eee"))}),t.deleteItem=function(e,o){var t=$(".collect ion-delete-button").eq(e);o.delete?(delete o.delete,t.css("color","#eee")):(o.delete=1,t.css("color","#fcb814"))},t.deleteItems=function(){for(var e=0;e<t.items.length;e++)t.items[e].delete&&function(e){n.delete({videocode:e},function(o){"000"==o.code?angular.forEach(t.items,function(o,i){o.code==e&&t.items.splice(i,1)}):r.show(o.msg)})}(t.items[e].code)}}]})}(),function(){angular.module("mobile").component("localCache",{templateUrl:"views/local-cache/local-cache.html",controller:["$location","$rootScope","$scope","$state","localCacheService","$ionicViewSwitcher","$cordovaFileTransfer","$timeout","$window","$cordovaFile",function(e,o,t,i,n,r,a,c,s,l){t.items=n.Cache_list,t.openVideo=function(e){o.video.code=e,o.openVideo()},t.$on("inread.editLocalCache",function(){t.shouldShowDelete=!t.shouldShowDelete,t.deleteItems()}),t.$on("inread.slideChangeStart",function(e,o){if(o&&2==o)t.shouldShowDelete=!1;else for(var i=0;i<t.items.length;i++)t.items[i].delete&&(delete t.items[i].delete,$(".cache ion-delete-button").css("color","#eee"))}),t.deleteItem=function(e,o){var t=$(".cache ion-delete-button").eq(e);o.delete?(delete o.delete,t.css("color","#eee")):(o.delete=1,t.css("color","#fcb814"))},t.deleteItems=function(){if(t.items){for(var e=[],o=0;o<t.items.length;o++)t.items[o].delete&&e.push(t.items[o].hash_key);angular.forEach(e,function(e,o){n.removeCache(e)}),t.items=n.Cache_list}}}]}).factory("localCacheService",["$cordovaFileTransfer","$cordovaFile","$window","$timeout","$interval","$ionicPlatform","SHARPNESS","SHARPNESS_NAME","messageService",function(e,o,t,i,n,r,a,c,s){function l(e){var o=(new Date).getTime();e.hash_key=o,t.localStorage.setItem("local_cache_"+o,JSON.stringify(e))}function d(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var o=16*Math.random()|0;return("x"==e?o:3&o|8).toString(16)})}var u=[];return r.ready(function(){for(var e=localStorage.length-1;e>=0;e--){var o=localStorage.key(e);if(o.indexOf("local_cache_")>-1){var t=JSON.parse(localStorage.getItem(o));u.push(t)}}u.sort(function(e,o){return e.hash_key-o.hash_key})}),{Cache_list:u,addCache:function(o,t){if(o){var i={cover_picture_url:o.cover_picture_url,name:o.name,pixel_code:t,code:o.code};for(var r in a)a[r]==t&&(i.pixel_label=c[r]);if("undefined"==typeof cordova){i.target_dir="",i.target_file=o.sources["url"+t];var m=0,f=n(function(){(m+=500)>=2e3&&(m=2e3),i.size=1.953125.toFixed(2),i.rate=(m/2e3*100).toFixed(1),100==parseInt(i.rate)&&(n.cancel(f),i.finished=!0,l(i))},400)}else{var p=d()+".rar",h=cordova.file.dataDirectory;i.target_dir=h,i.target_file=p,e.download(o.sources["url"+t],h+p,null,!0).then(function(e){l(i)},function(e){s.show(e)},function(e){i.size=(e.total/1024/1024).toFixed(2),i.rate=(e.loaded/e.total*100).toFixed(1),100==parseInt(i.rate)&&(i.finished=!0)})}u.unshift(i)}},removeCache:function(e){if(e){var i=t.localStorage.getItem("local_cache_"+e);if(i)if("undefined"==typeof cordova)t.localStorage.removeItem("local_cache_"+e),angular.forEach(u,function(o,t){o.hash_key==e&&u.splice(t,1)});else{t.localStorage.removeItem("local_cache_"+e),angular.forEach(u,function(o,t){o.hash_key==e&&u.splice(t,1)});var n=JSON.parse(i);o.removeFile(n.target_dir,n.target_file).then(function(e){},function(e){})}}}}}]).constant("SHARPNESS",{STANDARD:"1",HIGH:"2",SUPER:"3"}).constant("SHARPNESS_NAME",{STANDARD:"标清",HIGH:"高清",SUPER:"超清"})}(),function(){function e(e,o,t,i,n,r,a,c,s,l,d,u,m,f,p,h,g,v,$,w,b,S){function x(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var o=16*Math.random()|0;return("x"==e?o:3&o|8).toString(16)})}t.videoInfo={},t.goBack=function(){g.goBack()},t.clickVideo=function(){t.firstPlay||d.save({videocode:t.videoInfo.code},function(e){e.code}),t.firstPlay=!0},t.$on("$ionicView.beforeEnter",function(e,r){p.showBar(!1),t.firstPlay=!1,t.isCaching=!1,t.showPoster=!0,t.videoInfo.code=h.code,t.videoInfo.sources={url1:null,url2:null,url3:null},t.config={playsInline:!0,plugins:{controls:{autoHide:!0,autoHideTime:3e3},titleBar:{clickLeftButton:t.goBack}},initSharpness:o.networkState&&o.networkState==Connection.WIFI?S.HIGH:S.STANDARD};for(var a={},c=i.Cache_list.length-1;c>=0;c--){var s=c;if((a=i.Cache_list[c]).code.indexOf(t.videoInfo.code)>-1){if("undefined"!=typeof cordova)if(a.temp_sources)m.checkFile(cordova.file.cacheDirectory,a.temp_sources).then(function(e){t.videoInfo.cache_sources=cordova.file.cacheDirectory+a.temp_sources,t.videoInfo.cache_pixel=a.pixel_code,t.videoInfo.sources["url"+t.videoInfo.cache_pixel]=t.videoInfo.cache_sources,t.config.sources=[{src:n.trustAsResourceUrl(t.videoInfo.cache_sources),type:"video/mp4"}]},function(e){i.removeCache(s,a.hash_key),t.getVideoRemote()});else{var l=x()+".mp4";m.copyFile(a.target_dir,a.target_file,cordova.file.cacheDirectory,l).then(function(e){a.temp_sources=l,t.videoInfo.cache_sources=cordova.file.cacheDirectory+a.temp_sources,t.videoInfo.cache_pixel=a.pixel_code,t.videoInfo.sources["url"+t.videoInfo.cache_pixel]=t.videoInfo.cache_sources,t.config.sources=[{src:n.trustAsResourceUrl(t.videoInfo.cache_sources),type:"video/mp4"}],localStorage.setItem(key,JSON.stringify(a))},function(e){t.getVideoRemote()})}else t.videoInfo.cache_sources=a.target_dir+a.target_file,t.videoInfo.cache_pixel=a.pixel_code,t.videoInfo.sources["url"+t.videoInfo.cache_pixel]=t.videoInfo.cache_sources,t.config.sources=[{src:n.trustAsResourceUrl(t.videoInfo.cache_sources),type:"video/mp4"}];t.config.initSharpness=a.pixel_code+"",t.videoInfo.cover_picture_url=a.cover_picture_url,t.config.plugins.poster=t.videoInfo.cover_picture_url,t.isCached=!0;break}}t.getVideoRemote()}),t.getVideoRemote=function(){l.get({cat:"video",code:t.videoInfo.code},function(e){if("000"==e.code){if(!e.data)return;if(t.videoInfo.name=e.data.name,t.videoInfo.description=e.data.description,t.videoInfo.isCollect="1"==e.data.favourite,t.isCached)t.videoInfo.sources=JSON.parse(e.data.vendor_url),t.videoInfo.sources["url"+t.videoInfo.cache_pixel]=t.videoInfo.cache_sources,t.config.origin_sources=t.videoInfo.sources;else{var o="";t.videoInfo.sources=JSON.parse(e.data.vendor_url),t.videoInfo.cover_picture_url=e.data.cover_picture_url||"img/poster_detail.png",t.config.origin_sources=t.videoInfo.sources,t.config.initSharpness==S.HIGH?null!=t.videoInfo.sources.url2?o=t.videoInfo.sources.url2:(o=t.videoInfo.sources.url1,t.config.initSharpness=S.STANDARD):o=t.videoInfo.sources.url1,t.config.sources=[{src:n.trustAsResourceUrl(o),type:"video/mp4"}],t.config.plugins.poster=t.videoInfo.cover_picture_url}}else f.show(e.msg)})},t.cache=function(){if(t.isCached)t.goCacheList();else{var e=[];t.videoInfo.sources&&(null!=t.videoInfo.sources.url1&&e.push({text:"标清"}),null!=t.videoInfo.sources.url2&&e.push({text:"高清"}),null!=t.videoInfo.sources.url3&&e.push({text:"超清"}));a.show({buttons:e,cancelText:"取消",cancel:function(){},buttonClicked:function(e){return i.addCache(t.videoInfo,e+1),t.isCached=!0,t.isCaching=!0,r(function(){t.isCaching=!1,t.$apply()},3e3),!0}})}},t.collect=function(){t.videoInfo.code&&(t.videoInfo.isCollect?u.delete({videocode:t.videoInfo.code},function(e){"000"==e.code&&(t.videoInfo.isCollect=!1)}):u.save({videocode:t.videoInfo.code},function(e){"000"==e.code&&(t.videoInfo.isCollect=!0)}))},t.goCacheList=function(){switch(o.skipToCache=!0,c.current.name){case"home.index-video":return s.nextDirection("swap"),window.location.href="#/home/inread",void r(function(){g.clearHistory()},500)}o.$broadcast("videoDetail.skipToCache"),g.goBack()},t.videoUrl=function(e){return n.trustAsResourceUrl(e)},t.changeFullscreenStatus=function(e){var o=!!e;v.showBar(!o),t.isFullscreen=o,w.$getByHandle("videoPage").freezeScroll(e),t.isCaching=!1},t.$watch("isFullscreen",function(e){"undefined"!=typeof cordova&&(e?$.hide():$.show())})}angular.module("mobile").config(["$locationProvider","$stateProvider","$urlRouterProvider","$httpProvider",function(o,t,i,n){t.state("home.index-video",{url:"/index-video/:code",param:{code:null},views:{"tab-index":{templateUrl:"views/video-detail/video-detail.html",controller:["$location","$rootScope","$scope","localCacheService","$sce","$timeout","$ionicActionSheet","$state","$ionicViewSwitcher","CourseInfoService","StudyService","LessonFavouriteService","$cordovaFile","messageService","$ionicTabsDelegate","$stateParams","$ionicHistory","$ionicNavBarDelegate","$cordovaStatusbar","$ionicScrollDelegate","$ionicConfig","SHARPNESS",e]}}}),t.state("home.inread-video",{url:"/inread-video/:code",param:{code:null},views:{"tab-inread":{templateUrl:"views/video-detail/video-detail.html",controller:["$location","$rootScope","$scope","localCacheService","$sce","$timeout","$ionicActionSheet","$state","$ionicViewSwitcher","CourseInfoService","StudyService","LessonFavouriteService","$cordovaFile","messageService","$ionicTabsDelegate","$stateParams","$ionicHistory","$ionicNavBarDelegate","$cordovaStatusbar","$ionicScrollDelegate","$ionicConfig","SHARPNESS",e]}}})}]).filter("trustUrl",["$sce",function(e){return function(o){return o?e.trustAsResourceUrl(o):""}}]).filter("trustHtml",["$sce",function(e){return function(o){return o?e.trustAsHtml(o):""}}]).directive("videoBackgroundHeight",["$timeout",function(e){return{restrict:"A",scope:{},link:function(e,o,t){o.css("height",o.closest("ion-content").height())}}}])}(),angular.module("mobile").controller("H5DetailController",["$location","$rootScope","$scope","$state","$ionicViewSwitcher","$ionicHistory","StudyService","$timeout","$ionicPlatform","$stateParams","$ionicTabsDelegate","CourseInfoService","messageService",function(e,o,t,i,n,r,a,c,s,l,d,u,m){i.current.name.indexOf("extlink")>=0?(t.page_title="",$("#h5frame").attr("src",l.code)):u.get({cat:"h5-courseware",code:l.code},function(e){"000"==e.code?(a.create({coursewareid:l.code},function(e){}),t.page_title=e.data.name,$("#h5frame").attr("src",e.data.h5_url)):m.show(e.msg)}),t.$on("$ionicView.beforeEnter",function(e,o){void 0!==screen.orientation&&screen.orientation.unlock()}),t.$on("$ionicView.afterLeave",function(e,o){void 0!==screen.orientation&&screen.orientation.lock("portrait")}),t.goBack=function(){r.goBack()},d.showBar(!1)}]).config(["$locationProvider","$stateProvider","$urlRouterProvider","$httpProvider",function(e,o,t,i){o.state("home.index-h5detail",{url:"/h5detail/code/:code/:url",views:{"tab-index":{templateUrl:"views/h5-detail/h5-detail.html",controller:"H5DetailController"}}}).state("home.inread-h5detail",{url:"/h5detail/code/:code/:url",views:{"tab-inread":{templateUrl:"views/h5-detail/h5-detail.html",controller:"H5DetailController"}}}),o.state("home.index-extlink",{url:"/extlink/code/:code",views:{"tab-index":{templateUrl:"views/h5-detail/h5-detail.html",controller:"H5DetailController"}}}).state("home.inread-extlink",{url:"/extlink/code/:code",views:{"tab-inread":{templateUrl:"views/h5-detail/h5-detail.html",controller:"H5DetailController"}}})}]),angular.module("mobile").controller("VideoViewerController",["$location","$rootScope","$scope","$sce","$timeout","$ionicActionSheet","$state","$ionicViewSwitcher","CourseInfoService","StudyService","$cordovaFileTransfer","LessonFavouriteService","$ionicPlatform","$ionicHistory","$stateParams","messageService","$ionicNavBarDelegate","$ionicScrollDelegate","$ionicConfig","$cordovaStatusbar",function(e,o,t,i,n,r,a,c,s,l,d,u,m,f,p,h,g,v,w,b){t.pictureLevel=1,t.videoInfo={},t.isFullscreen=!1,t.$on("$ionicView.beforeEnter",function(e,o){t.config={playsInline:!0,plugins:{controls:{autoHide:!0,autoHideTime:3e3},titleBar:{clickLeftButton:t.goBack}}},s.get({cat:"h5-courseware",code:p.code},function(e){"000"==e.code?(t.videoInfo.code=p.code,t.videoInfo.name=e.data.name,t.videoInfo.cover_picture_url=e.data.cover_picture_url||"img/poster_detail.png",t.videoInfo.vendor_url=JSON.parse(e.data.vendor_url),t.config.plugins.poster={url:t.videoInfo.cover_picture_url},t.config.sources=[{src:i.trustAsResourceUrl(t.videoInfo.vendor_url["url"+t.pictureLevel]),type:"video/mp4"}],t.config.origin_sources=t.videoInfo.vendor_url,l.save({coursewareid:p.code},function(e){})):h.show(e.msg)})}),t.changeFullscreenStatus=function(e){var o=!!e;g.showBar(!o),t.isFullscreen=o,v.$getByHandle("videoPage1").freezeScroll(e),w.views.swipeBackEnabled(!e)},t.$watch("isFullscreen",function(e){"undefined"!=typeof cordova&&(e?b.hide():b.show())}),t.autoFullScreenPlay=function(){$("vg-fullscreen-button button").eq(0).click(),$("vg-play-pause-button button").eq(0).click()},t.goBack=function(){f.goBack()}}]).config(["$locationProvider","$stateProvider","$urlRouterProvider","$httpProvider",function(e,o,t,i){o.state("home.index-h5video",{url:"/h5video/code/:code/:url",views:{"tab-index":{templateUrl:"views/video-viewer/video-viewer.html",controller:"H5DetailController"}}}).state("home.inread-h5video",{url:"/h5video/code/:code/:url",views:{"tab-inread":{templateUrl:"views/video-viewer/video-viewer.html",controller:"H5DetailController"}}})}]),function(){angular.module("mobile").config(["$locationProvider","$stateProvider","$urlRouterProvider","$httpProvider",function(e,o,t,i){o.state("home.modify-user",{url:"/modify-user",views:{"tab-usercenter":{templateUrl:"views/modify-user/modify-user.html",controller:"modifyUserController"}}})}]).controller("modifyUserController",["$location","$rootScope","$scope","$state","$stateParams","userService","$ionicActionSheet","$ionicHistory","$ionicTabsDelegate","uploadFileService",function(e,o,t,i,n,r,a,c,s,l){function d(){l.upload({allowEdit:!0},"UP-PROFILE-PICTURES",1,function(e){if(200==e.responseCode){var o=JSON.parse(e.response);"000"==o.code&&t.updatePicture(o.data.url)}},function(e){},function(e){})}function u(){l.upload({},"UP-PROFILE-PICTURES",0,function(e){if(200==e.responseCode){var o=JSON.parse(e.response);"000"==o.code&&t.updatePicture(o.data.url)}},function(e){},function(e){})}s.showBar(!1),t.updatePicture=function(e){r.update({profilepicture:e},function(t){"000"==t.code?o.userInfo.profilepicture=e:messageService.show(t.msg)})},t.changeImage=function(){a.show({buttons:[{text:"拍摄"},{text:"相册"}],cancelText:"取消",cancel:function(){},buttonClicked:function(e){switch(e){case 0:d();break;case 1:u()}return!0}})},t.save=function(){r.update({username:o.userInfo.username,profilepicture:o.userInfo.profilepicture},function(e){"000"==e.code&&c.goBack()})},t.$on("$ionicView.beforeEnter",function(){"userInfo"in o||r.get({ACTION:"ONE"},function(e){"000"==e.code&&(o.userInfo={profilepicture:e.data.profilepicture,username:e.data.username,mobile:e.data.mobile})})})}])}(),function(){angular.module("mobile").config(["$locationProvider","$stateProvider","$urlRouterProvider","$httpProvider",function(e,o,t,i){o.state("home.modify-mobile",{url:"/modify-mobile",views:{"tab-usercenter":{templateUrl:"views/modify-mobile/modify-mobile.html",controller:"modifyMobileController"}}})}]).controller("modifyMobileController",["$location","$rootScope","$scope","$state","userService","$ionicHistory","$interval","messageService",function(e,o,t,i,n,r,a,c){t.data={mobile:""},t.setFocus={isFocus:!1},t.sendcodeText="发送验证码",t.save=function(){t.data.mobile&&11==t.data.mobile.length?n.update({mobile:t.data.mobile,code:t.data.v_code},function(e){"000"==e.code?r.goBack():c.show(e.msg)}):c.show("请输入11位的手机号码",1e3)},t.limitMobile=function(){t.data.mobile&&t.data.mobile.length>11&&(t.data.mobile=t.data.mobile.substring(0,11))},t.limitCode=function(){t.data.v_code&&t.data.v_code.length>4&&(t.data.v_code=t.data.v_code.substring(0,4))},t.sendValidCode=function(){t.count>0||(t.data.mobile&&11==t.data.mobile.length?n.get({ACTION:"SMS",mobile:t.data.mobile},function(e){"000"==e.code?(t.setFocus.isFocus=!0,t.count=59,t.sendcodeText=t.count+"s后重发",t.resperror="",t.timerHandler=a(function(){t.count<=0?(a.cancel(t.timerHandler),t.sendcodeText="发送验证码"):(t.sendcodeText=t.count+"s后重发",t.count--)},1e3)):c.show(e.msg,1e3)}):c.show("请输入11位的手机号码",1e3))}}])}(),function(){angular.module("mobile").config(["$locationProvider","$stateProvider","$urlRouterProvider","$httpProvider",function(e,o,t,i){o.state("home.modify-username",{url:"/modify-username",views:{"tab-usercenter":{templateUrl:"views/modify-username/modify-username.html",controller:"modifyUsernameController"}}})}]).controller("modifyUsernameController",["$location","$rootScope","$scope","$state","userService","$ionicHistory","$stateParams","messageService",function(e,o,t,i,n,r,a,c){t.data={username:o.userInfo.username},t.save=function(){n.update({username:t.data.username},function(e){"000"==e.code?(o.userInfo.username=t.data.username,r.goBack()):c.show(e.msg)})}}])}(),function(){angular.module("mobile").config(["$locationProvider","$stateProvider","$urlRouterProvider","$httpProvider",function(e,o,t,i){o.state("home.message",{url:"/message",views:{"tab-index":{templateUrl:"views/message/message.html",controller:"messageController"}}})}]).factory("noticeJumpService",["$timeout","$state","$rootScope","$ionicViewSwitcher",function(e,o,t,i){return{skipTo:function(n){if(n)switch(n){case"我的合伙人":window.location.href="#/home/user-center",e(function(){o.go("home.my-partner")},100);break;case"收益详情":window.location.href="#/home/user-center",e(function(){i.nextDirection("swap"),o.go("home.my-partner"),e(function(){i.nextDirection("forward"),o.go("home.bonus-detail",{type:"DETAIL-MONTH-PROFIT"})},100)},50);break;case"我的团队":window.location.href="#/home/user-center",e(function(){o.go("home.my-partner"),t.skipToMember=!0},100);break;case"我的":window.location.href="#/home/user-center";break;case"提现详情":window.location.href="#/home/user-center",e(function(){o.go("home.withdraw-detail")},100)}}}}]).controller("messageController",["$location","$rootScope","$scope","$state","$ionicTabsDelegate","NoticeService","messageService","$ionicScrollDelegate","$timeout","$ionicHistory","noticeJumpService",function(e,o,t,i,n,r,a,c,s,l,d){t.$on("$ionicView.beforeEnter",function(e,o){n.showBar(!1),t.messages=[],t.pageindex=0,t.pagesize=10,t.loading=!1,t.noMoreRecord=!0,t.loadMore()}),t.$on("message.read",function(e,o){"id"in o&&angular.forEach(t.messages,function(e,t){e.id==o.id&&(e.isread=!0)})}),t.loadMore=function(){t.loading=!0,r.query({pageindex:t.pageindex,pagesize:t.pagesize},function(e){if("000"==e.code){e.data.length<t.pagesize?t.noMoreRecord=!0:t.noMoreRecord=!1;for(var o=[],i=0;i<e.data.length;i++){var n=e.data[i],r=JSON.parse(n.extras);o.push({id:n.id,title:n.alert,date:n.entry_date,isread:"1"==n.isread,content:r.content,state:r.state,jump:r.jump})}0==t.pageindex?t.messages=o:t.messages=t.messages.concat(o),t.pageindex+=1}t.$broadcast("scroll.infiniteScrollComplete"),t.loading=!1},function(e){t.noMoreRecord=!0,t.loading=!1,t.$broadcast("scroll.infiniteScrollComplete")})},t.skipToDetail=function(e){if(e){r.get({id:e.id},function(o){"000"==o.code?e.isread=!0:a.show(o.msg)});var o=l.viewHistory(),t=l.currentHistoryId(),i=o.histories[t],n=i.cursor,c=i.stack[n],s=i.stack[n-1];c&&(i.stack.splice(n,1),l.clearCache([c.viewId]),s.forwardViewId=null,s.backViewId=null,o.backView=null,o.forwardView=null,o.currentView=s,i.cursor+=-1),d.skipTo(e.jump)}}}])}(),function(){angular.module("mobile").config(["$locationProvider","$stateProvider","$urlRouterProvider","$httpProvider",function(e,o,t,i){o.state("home.message-detail",{url:"/message-detail/:id",param:{id:null},views:{"tab-index":{templateUrl:"views/message-detail/message-detail.html",controller:"messageDetailController"}}})}]).controller("messageDetailController",["$location","$rootScope","$scope","$state","NoticeService","$stateParams","messageService",function(e,o,t,i,n,r,a){n.get({id:r.id},function(e){if("000"==e.code){var o=e.data;t.message={id:o.id,title:o.alert,date:o.entry_date,content:JSON.parse(o.extras).content,state:JSON.parse(o.extras).state}}else a.show(e.msg)}),o.$broadcast("message.read",{id:r.id})}])}(),function(){angular.module("mobile").config(["$locationProvider","$stateProvider","$urlRouterProvider","$httpProvider",function(e,o,t,i){o.state("home.bind-card",{url:"/bind-card/{edit}",param:{edit:null},views:{"tab-usercenter":{templateUrl:"views/bind-card/bind-card.html",controller:"bindCardController"}}})}]).controller("bindCardController",["$location","$rootScope","$scope","$state","commissionService","$stateParams","$ionicHistory","$ionicViewSwitcher","messageService",function(e,o,t,i,n,r,a,c,s){t.data={accountname:"",accountbank:"",accountnumber:""},t.$on("bank.selected",function(e,o){t.data.accountbank=o.bank.name,t.data.icon=o.bank.icon}),t.clickBindCard=function(e){var o=$.extend({ACTION:"BIND-BANK"},t.data);n.update(o,function(e){"000"==e.code?r.edit&&"1"==r.edit?(c.nextDirection("back"),a.goBack()):i.go("home.withdraw"):(c.nextDirection("back"),s.show(e.msg))})}}])}(),function(){angular.module("mobile").config(["$locationProvider","$stateProvider","$urlRouterProvider","$httpProvider",function(e,o,t,i){o.state("home.withdraw",{url:"/withdraw",views:{"tab-usercenter":{templateUrl:"views/withdraw/withdraw.html",controller:"withdrawController"}}})}]).controller("withdrawController",["$location","$rootScope","$scope","$state","commissionService","$interval","messageService","$ionicHistory","$ionicViewSwitcher",function(e,o,t,i,n,r,a,c,s){t.send_code_text="发送验证码",t.clickWithdraw=function(){n.save({ACTION:"APPLY-COMMISSION",code:t.data.code},function(e){"000"==e.code?i.go("home.binding"):(s.nextDirection("back"),a.show(e.msg))})},t.init=function(){c.backView()&&"home.bind-card"==c.backView().stateName&&c.removeBackView(),t.data={code:""};var e={ACTION:"GET-AVAILABLE-AMOUNT"};n.get(e,function(e){"000"==e.code&&(t.amount=e.data.amount,t.accountbank=e.data.accountbank,t.accountnumber=e.data.accountnumber,t.amount<5?t.tip="温馨提示：提现金额必须大于等于5元":t.tip="温馨提示：本次提现抽取1%手续费，手续费最低2元，80元封顶")})},t.changeBankInfo=function(){i.go("home.bind-card",{edit:1})},t.sendValidCode=function(){if(!t.timerHandler){var e={ACTION:"GET-SMS"};n.get(e,function(e){"000"==e.code&&(t.count=59,t.send_code_text=t.count+"s后可重发",t.timerHandler=r(function(){t.count<=0?(r.cancel(t.timerHandler),delete t.timerHandler,t.send_code_text="发送验证码"):(t.send_code_text=t.count+"s后可重发",t.count--)},1e3))})}},t.$on("$ionicView.beforeEnter",function(){t.init()})}])}(),function(){angular.module("mobile").config(["$locationProvider","$stateProvider","$urlRouterProvider","$httpProvider",function(e,o,t,i){o.state("home.binding",{url:"/binding",views:{"tab-usercenter":{templateUrl:"views/binding/binding.html",controller:"bindingController"}}})}]).controller("bindingController",["$location","$rootScope","$scope","$state","bindingService","$ionicHistory","$ionicViewSwitcher",function(e,o,t,i,n,r,a){t.goBack=function(){r.goBack()},t.$on("$ionicView.enter",function(e){r.backView()&&"home.withdraw"==r.backView().stateName&&r.removeBackView()})}]).factory("bindingService",["$resource",function(e){return e("/binding/")}])}(),function(){angular.module("mobile").config(["$locationProvider","$stateProvider","$urlRouterProvider","$httpProvider",function(e,o,t,i){o.state("home.withdraw-detail",{url:"/withdraw-detail",views:{"tab-usercenter":{templateUrl:"views/withdraw-detail/withdraw-detail.html",controller:"withdrawDetailController"}}})}]).controller("withdrawDetailController",["$location","$rootScope","$scope","$state","myPartnerService","messageService",function(e,o,t,i,n,r){t.withdraws=[],t.pageindex=0,t.pagesize=10,t.loading=!1,t.noMoreRecord=!1,t.loadMore=function(){t.loading=!0;var e={ACTION:"DETAIL-APPLY-COMMISSION",pageindex:t.pageindex,pagesize:t.pagesize};n.get(e,function(e){"000"==e.code?(e.data.list.length<t.pagesize?t.noMoreRecord=!0:t.noMoreRecord=!1,0==t.pageindex?t.withdraws=e.data.list:t.withdraws=t.withdraws.concat(e.data.list),t.pageindex+=1):r.show(e.msg),t.$broadcast("scroll.infiniteScrollComplete"),t.loading=!1},function(e){r.show(e),t.noMoreRecord=!0,t.loading=!1,t.$broadcast("scroll.infiniteScrollComplete")})}}])}(),function(){angular.module("mobile").config(["$locationProvider","$stateProvider","$urlRouterProvider","$httpProvider",function(e,o,t,i){o.state("home.third-page",{url:"/third-page/:category/:title",param:{category:null,title:null},views:{"tab-usercenter":{templateUrl:"views/third-page/third-page.html",controller:"thirdPageController"}}})}]).controller("thirdPageController",["$location","$rootScope","$scope","$state","thirdPageService","$stateParams","$ionicTabsDelegate",function(e,o,t,i,n,r,a){r.category&&(t.title=r.title,t.category=r.category),a.showBar(!1),t.init=function(){switch(t.category){case"contact-customer":t.src="https://www.huizeguoxue.com/guoxue/content.html?k=guoxue-content-custom-service";break;case"often-issue":t.src="https://www.huizeguoxue.com/guoxue/content.html?k=guoxue-content-faq"}},t.init()}]).factory("thirdPageService",["$resource",function(e){return e("/third-page/")}])}(),angular.module("mobile").controller("ChapterCtrl",["$stateParams","$location","$rootScope","$scope","$state","$ionicModal","$ionicViewSwitcher","$ionicTabsDelegate","$ionicHistory","ChapterService","CourseInfoService","H5ClassService","$ionicScrollDelegate","$timeout","$ionicPlatform","$ionicTabsDelegate","StudyService","messageService",function(e,o,t,i,n,r,a,c,s,l,d,u,m,f,p,c,h,g){function v(){d.get({cat:"h5",code:e.code},function(e){if("000"==e.code){i.chapterClass=e.data.h5,i.chapterClass.introduction_classes=e.data.h5introduction,i.chapterClass.chapters=e.data.h5chapter.sort(function(e,o){return e.sequence-o.sequence});var o=0;e.data.progress&&e.data.progress.progress&&(o=Math.floor(100*(e.data.progress.progress||0))),i.chapterClass.progress=o;for(var t=0;t<i.chapterClass.chapters.length;t++){var n=i.chapterClass.chapters[t];n.items=[];for(var r=0;r<e.data.h5courseware.length;r++){var a=e.data.h5courseware[r];n.id==a.chapterid&&n.items.push({id:a.id,name:a.name,isstudied:a.isstudied,h5_url:a.h5_url,vendor_url:a.vendor_url,cat:""!=a.h5_url?"h5":"video",cover_picture_url:a.cover_picture_url,sequence:0|a.sequence})}n.items=n.items.sort(function(e,o){return e.sequence-o.sequence})}}else g.show(e.msg)})}c.showBar(!1),i.chapterBack=function(){a.nextDirection("back"),s.goBack()},i.classList=[],i.selectedChapterID=0,i.$on("$ionicView.beforeEnter",function(e,o){v()}),i.selectChapter=function(e){i.selectedChapterID==e?i.selectedChapterID=-1:(i.selectedChapterID=e,f(function(){m.$getByHandle("chapterviewer").resize()}))}}]).config(["$locationProvider","$stateProvider","$urlRouterProvider","$httpProvider",function(e,o,t,i){o.state("home.index-h5",{url:"/h5/code/:code",views:{"tab-index":{templateUrl:"views/chapter-class/chapter-class.html",controller:"ChapterCtrl"}}}),o.state("home.inread-h5",{url:"/h5/code/:code",param:{code:null},views:{"tab-inread":{templateUrl:"views/chapter-class/chapter-class.html",controller:"ChapterCtrl"}}})}]),function(){angular.module("mobile").config(["$locationProvider","$stateProvider","$urlRouterProvider","$httpProvider",function(e,o,t,i){o.state("home.bank-list",{url:"/bank-list",views:{"tab-usercenter":{templateUrl:"views/bank-list/bank-list.html",controller:"bankListController"}}})}]).controller("bankListController",["$location","$rootScope","$scope","$state","$ionicHistory","commissionService","messageService",function(e,o,t,i,n,r,a){r.query({ACTION:"GET-AVAILABLE-BANKS"},function(e){"000"==e.code?t.banks=e.data:a.show(e.msg)}),t.select=function(e){t.select_bank=e,n.goBack()},t.$on("$ionicView.beforeLeave",function(e,i){t.select_bank&&o.$broadcast("bank.selected",{bank:t.select_bank})})}])}(),angular.module("mobile").directive("hideTabs",function(e){return{restrict:"A",link:function(o,t,i){console.log("hide"),o.$on("$ionicView.beforeEnter",function(){o.$watch(i.hideTabs,function(o){e.hideTabs=o})}),o.$on("$ionicView.beforeLeave",function(){e.hideTabs=!1})}}}),angular.module("mobile").directive("imgSize",function(e){return{restrict:"A",link:function(e,o,t){var i=100;t.imgSize.indexOf("%")>-1&&(i=o.parent().width()*parseFloat(t.imgSize.replace("%",""))/100),o.css({width:i+"px",height:i+"px"})}}}),angular.module("mobile").directive("videoSize",["$timeout",function(e){return{restrict:"A",link:function(o,t,i){e(function(){var e=document.body.offsetWidth;if(i.videoSize.indexOf("%")>-1){var o=t.parent().width();0!=o&&(e=o*parseFloat(i.videoSize.replace("%",""))/100)}t.css({width:e+"px",height:(9*e/16).toFixed(2)+"px"})})}}}]),angular.module("mobile").directive("qrcodeSize",function(e){return{restrict:"A",link:function(e,o,t){var i=100;t.qrcodeSize.indexOf("%")>-1&&(i=o.parent().width()*parseFloat(t.qrcodeSize.replace("%",""))/100),t.size=i}}}),angular.module("mobile").directive("limitLength",function(){return{restrict:"A",require:"?^ngModel",link:function(e,o,t,i){var n=Number(t.limitLength);i.$parsers.push(function(e){if(e.length>n){var o=e.substring(0,n);return i.$setViewValue(o),i.$render(),o}return e})}}}),angular.module("mobile").directive("setFocus",[function(){return{restrict:"A",scope:{setFocus:"="},link:function(e,o){e.$watch("setFocus",function(e,t,i){console.log(e),e&&1==e.isFocus&&(o[0].focus(),i.setFocus.isFocus=!1)},!0)}}}]),angular.module("mobile").filter("nullState",[function(){return function(e,o){return e||(o||"")}}]),angular.module("mobile").filter("NonNullDesc",[function(){return function(e,o,t){return e?(o||"")+e+(t||""):""}}]),angular.module("mobile").filter("toDate",[function(){return function(e,o){return e?new Date(e):""}}]),angular.module("mobile").filter("right",[function(){return function(e,o){return e?e.length-o>=0&&e.length>=0&&e.length-o<=e.length?e.substring(e.length-o,e.length):e:""}}]),function(e){e.module("mobile").factory("messageService",["$ionicLoading",function(e){return{show:function(o,t,i){e.show({template:o,duration:t||2e3,noBackdrop:1}).then(function(){i&&"function"==typeof i&&i()})},hide:function(o){e.hide().then(function(){o&&"function"==typeof o&&o()})}}}])}(angular),function(e){e.module("mobile").factory("jpushService",["noticeJumpService",function(e){function o(o){window.JPush&&("Android"==device.platform?o.alert:o.aps.alert,e.skipTo(o.extras.state))}return{start:function(){window.JPush&&(window.JPush.init(),window.JPush.isPushStopped(function(e){console.log("isPushStopped:"+e),0==e||window.JPush.resumePush(),window.JPush.setDebugMode(!0),document.addEventListener("jpush.openNotification",o,!1)}))},isPushStopped:function(e){window.JPush&&window.JPush.isPushStopped(e)},stopPush:function(){window.JPush&&window.JPush.stopPush()},setAlias:function(e,o,t){window.JPush&&window.JPush.setAlias({sequence:1,alias:e},function(e){o(e)},function(e){t(e)})},deleteAlias:function(e,o){window.JPush&&window.JPush.deleteAlias({sequence:1},function(o){e(o)},function(e){o(e)})},getAlias:function(){window.JPush&&window.JPush.getAlias({sequence:1},function(e){suc(e)},function(e){fail(e)})},getUserNotificationSettings:function(e){window.JPush&&window.JPush.getUserNotificationSettings(function(o){e(o)})},resetBadge:function(){window.JPush&&(window.JPush.setApplicationIconBadgeNumber(0),window.JPush.resetBadge())}}}])}(angular),function(e){e.module("mobile").factory("uploadFileService",["$cordovaFileTransfer","$cordovaCamera",function(e,o){return{upload:function(t,i,n,r,a,c){if(i&&0!=i.length&&"undefined"!=typeof cordova){var s=1==n,l={quality:100,destinationType:Camera.DestinationType.FILE_URI,sourceType:s?Camera.PictureSourceType.CAMERA:Camera.PictureSourceType.PHOTOLIBRARY,allowEdit:!1,encodingType:Camera.EncodingType.PNG,targetWidth:300,targetHeight:300,mediaType:0,cameraDirection:0,popoverOptions:CameraPopoverOptions,saveToPhotoAlbum:!0},d=$.extend(l,t);o.getPicture(d).then(function(o){e.upload(HOST+"service/applesson/file-upload",o,{params:{ACTION:i}}).then(function(e){"function"==typeof r&&r(e),console.log(e)},function(e){"function"==typeof a&&a(e),console.log(e)},function(e){"function"==typeof c&&c(e),console.log(e)}),console.log(o)},function(e){console.log(e.message)})}}}}])}(angular),function(e){e.module("mobile").factory("wechatShareService",["messageService",function(e){function o(o,t,i){var n={scene:o||0};if("send-text"==t)n.text=i;else switch(n.message={title:i.title||"",description:i.description||"",mediaTagName:"XIAOSHENGTONG-TAG-001",messageExt:"这是惠泽文化旗下的小神童分享链接",messageAction:"<action>dotalist</action>",media:{}},t){case"send-photo-local":case"send-photo-remote":n.message.media.type=Wechat.Type.IMAGE,n.message.media.image=i.media.image;break;case"send-link-thumb-local":case"send-link-thumb-remote":n.message.title=i.title,n.message.description=i.description,n.message.thumb=i.thumb,n.message.media.type=Wechat.Type.LINK,n.message.media.webpageUrl=i.media.webpageUrl;break;case"send-music":n.message.title=i.title,n.message.description=i.title,n.message.thumb=i.thumb,n.message.media.type=Wechat.Type.MUSIC,n.message.media.musicUrl="http://y.qq.com/i/song.html#p=7B22736F6E675F4E616D65223A22E4B880E697A0E68980E69C89222C22736F6E675F5761704C69766555524C223A22687474703A2F2F74736D7573696334382E74632E71712E636F6D2F586B30305156342F4141414130414141414E5430577532394D7A59344D7A63774D4C6735586A4C517747335A50676F47443864704151526643473444442F4E653765776B617A733D2F31303130333334372E6D34613F7569643D3233343734363930373526616D703B63743D3026616D703B636869643D30222C22736F6E675F5769666955524C223A22687474703A2F2F73747265616D31342E71716D757369632E71712E636F6D2F33303130333334372E6D7033222C226E657454797065223A2277696669222C22736F6E675F416C62756D223A22E4B880E697A0E68980E69C89222C22736F6E675F4944223A3130333334372C22736F6E675F54797065223A312C22736F6E675F53696E676572223A22E5B494E581A5222C22736F6E675F576170446F776E4C6F616455524C223A22687474703A2F2F74736D757369633132382E74632E71712E636F6D2F586C464E4D313574414141416A41414141477A4C36445039536A457A525467304E7A38774E446E752B6473483833344843756B5041576B6D48316C4A434E626F4D34394E4E7A754450444A647A7A45304F513D3D2F33303130333334372E6D70333F7569643D3233343734363930373526616D703B63743D3026616D703B636869643D3026616D703B73747265616D5F706F733D35227D",n.message.media.musicDataUrl="http://stream20.qqmusic.qq.com/32464723.mp3";break;case"send-video":n.message.title=i.title,n.message.description=i.title,n.message.thumb=i.thumb,n.message.media.type=Wechat.Type.VIDEO,n.message.media.videoUrl="http://v.youku.com/v_show/id_XNTUxNDY1NDY4.html";break;case"send-app":n.message.title=i.title,n.message.description=i.title,n.message.thumb=i.thumb,n.message.media.type=Wechat.Type.APP,n.message.media.extInfo="<xml>extend info</xml>",n.message.media.url="http://weixin.qq.com";break;case"send-nongif":case"send-gif":n.message.thumb=i.thumb,n.message.media.type=Wechat.Type.EMOTION,n.message.media.emotion=i.media.emotion;break;case"send-file":n.message.title=i.title,n.message.description=i.title,n.message.thumb=i.thumb,n.message.media.type=Wechat.Type.FILE,n.message.media.file=i.media.file;break;case"auth":return Wechat.auth("snsapi_userinfo",function(e){alert(JSON.stringify(e))},function(o){e.show("Failed: "+o)}),!0;default:return e.show(t+" can not be recognized!"),!1}Wechat.share(n,function(){e.show("分享成功")},function(o){e.show("分享失败: "+o)})}return{share:function(t,i,n){if("undefined"==typeof Wechat)return!1;Wechat.isInstalled(function(r){1==r?o(t,i,n):e.show("微信尚未安装！")})}}}])}(angular),function(e){e.module("mobile").factory("appUpdateService",["$cordovaFileTransfer","$cordovaFileOpener2","$ionicPopup","$ionicLoading","$timeout","messageService",function(e,o,t,i,n,r){return{showUpdateConfirm:function(n){var a=(n=n).url,c=(n.upgradeinfo,"");"undefined"!=typeof cordova&&cordova.file&&(c=cordova.file.externalDataDirectory+"XiaoShuTong.apk"),t.confirm({title:"版本升级",template:"有可升级的版本<br><b>V"+n.version+"</b>",okText:"升级"}).then(function(t){if(t){if(ionic.Platform.isIOS())return void cordova.InAppBrowser.open(a,"_blank","location=no");ionic.Platform.isAndroid()&&""!=a&&(i.show({template:"已经下载：0%"}),e.download(a,c,null,!0).then(function(e){o.open(c,"application/vnd.android.package-archive").then(function(){},function(e){r.show("安装文件打开失败, 请尝试手动安装.")}),i.hide()},function(e){i.hide(),r.show("请设置应用文件操作权限, 然后重试.")},function(e){var o=Math.floor(e.loaded/e.total*100);o>0&&i.show({template:"已经下载："+o+"%"}),o>99&&i.hide()}))}else window.haveCancelUpload=!0,i.hide(),1==n.isforce&&ionic.Platform.exitApp()})}}}])}(angular);