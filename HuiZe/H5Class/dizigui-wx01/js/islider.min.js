var isMouseDown=false;var iSlider=function(a){if(!a.dom){throw new Error("dom element can not be empty!")}if(!a.data||!a.data.length){throw new Error("data must be an array and must have more than one element!")}this._opts=a;this._setting();this._renderHTML();this._bindHandler()};iSlider.prototype._setting=function(){var a=this._opts;this.wrap=a.dom;this.data=a.data;this.type=a.type||"pic";this.isVertical=a.isVertical||false;this.onslide=a.onslide;this.onslidestart=a.onslidestart;this.onslideend=a.onslideend;this.onslidechange=a.onslidechange;this.duration=a.duration||2000;this.log=a.isDebug?function(b){console.log(b)}:function(){};this.axis=this.isVertical?"Y":"X";this.width=this.wrap.clientWidth;this.height=this.wrap.clientHeight;this.ratio=this.height/this.width;this.scale=a.isVertical?this.height:this.width;this.sliderIndex=this.sliderIndex||0;if(this.data.length<2){this.isLooping=false;this.isAutoPlay=false}else{this.isLooping=a.isLooping||false;this.isAutoplay=a.isAutoplay||false}if(this.isAutoplay){this.play()}this._setUpDamping();this._animateFunc=(a.animateType in this._animateFuncs)?this._animateFuncs[a.animateType]:this._animateFuncs["default"];this._setPlayWhenFocus()};iSlider.prototype._setPlayWhenFocus=function(){var a=this;window.addEventListener("focus",function(){a.isAutoplay&&a.play()},false);window.addEventListener("blur",function(){a.pause()},false)};iSlider.prototype._animateFuncs={"default":function(e,b,d,a,c){e.style.webkitTransform="translateZ(0) translate"+b+"("+(c+d*(a-1))+"px)"},rotate:function(g,b,f,a,e){var c=(b=="X")?"Y":"X";var d=Math.abs(e);var h=window.getComputedStyle(this.wrap.parentNode,null).backgroundColor;if(this.isVertical){e=-e}this.wrap.style.webkitPerspective=f*4;if(a==1){g.style.zIndex=f-d}else{g.style.zIndex=(e>0)?(1-a)*d:(a-1)*d}g.style.backgroundColor=h||"#333";g.style.position="absolute";g.style.webkitBackfaceVisibility="hidden";g.style.webkitTransformStyle="preserve-3d";g.style.webkitTransform="rotate"+c+"("+90*(e/f+a-1)+"deg) translateZ("+(0.888*f/2)+"px) scale(0.888)"},flip:function(f,b,e,a,d){var c=(b=="X")?"Y":"X";var g=window.getComputedStyle(this.wrap.parentNode,null).backgroundColor;if(this.isVertical){d=-d}this.wrap.style.webkitPerspective=e*4;if(d>0){f.style.visibility=(a>1)?"hidden":"visible"}else{f.style.visibility=(a<1)?"hidden":"visible"}f.style.backgroundColor=g||"#333";f.style.position="absolute";f.style.webkitBackfaceVisibility="hidden";f.style.webkitTransform="translateZ("+(e/2)+"px) rotate"+c+"("+180*(d/e+a-1)+"deg) scale(0.875)"},depth:function(g,b,f,a,e){var c=(b=="X")?"Y":"X";var d=(4-Math.abs(a-1))*0.15;this.wrap.style.webkitPerspective=f*4;if(a==1){g.style.zIndex=100;g.style.opacity="1"}else{g.style.zIndex=(e>0)?(1-a):(a-1);g.style.opacity="0.6"}g.style.webkitTransform="scale("+d+", "+d+") translateZ(0) translate"+b+"("+(e+1.3*f*(a-1))+"px)"},tear:function(g,b,f,a,e){var c=(b=="X")?"Y":"X";var d=1-(Math.abs(a-1)*0.2);this.wrap.style.webkitPerspective=f*4;if(a==1){g.style.zIndex=100}else{g.style.zIndex=(e>0)?(1-a):(a-1)}g.style.webkitTransform="scale("+d+", "+d+") translateZ(0) translate"+b+"("+(e+f*(a-1))+"px)"}};iSlider.prototype._setUpDamping=function(){var b=this.scale>>1;var a=b>>1;var c=a>>2;this._damping=function(f){var e=Math.abs(f);var d;if(e<b){d=e>>1}else{if(e<b+a){d=a+((e-b)>>2)}else{d=a+c+((e-b-a)>>3)}}return f>0?d:-d}};iSlider.prototype._renderItem=function(c){var d,b;var a=this.data.length;if(!this.isLooping){d=this.data[c]||{empty:true}}else{if(c<0){d=this.data[a+c]}else{if(c>a-1){d=this.data[c-a]}else{d=this.data[c]}}}if(d.empty){return""}if(this.type==="pic"){b=d.height/d.width>this.ratio?'<img height="'+this.height+'" src="'+d.content+'">':'<img width="'+this.width+'" src="'+d.content+'">'}else{if(this.type==="dom"){b='<div style="height:'+d.height+";width:"+d.width+';">'+d.content+"</div>"}else{if(this.type==="overspread"){b=this.ratio<1?'<div style="height: 100%; width:100%; background:url('+d.content+") center no-repeat; background-size:"+this.width+'px auto;"></div>':'<div style="height: 100%; width:100%; background:url('+d.content+") center no-repeat; background-size: auto "+this.height+'px;"></div>'}}}return b};iSlider.prototype._renderHTML=function(){var c;if(this.outer){this.outer.innerHTML="";c=this.outer}else{c=document.createElement("ul")}c.style.width=this.width+"px";c.style.height=this.height+"px";this.els=[];for(var b=0;b<3;b++){var a=document.createElement("li");a.style.width=this.width+"px";a.style.height=this.height+"px";this._animateFunc(a,this.axis,this.scale,b,0);this.els.push(a);c.appendChild(a);if(this.isVertical&&(this._opts.animateType=="rotate"||this._opts.animateType=="flip")){a.innerHTML=this._renderItem(1-b+this.sliderIndex)}else{a.innerHTML=this._renderItem(b-1+this.sliderIndex)}}if(!this.outer){this.outer=c;this.wrap.appendChild(c)}};iSlider.prototype._slide=function(f){var d=this.data;var c=this.els;var a=this.sliderIndex+f;if(d[a]){this.sliderIndex=a}else{if(this.isLooping){this.sliderIndex=f>0?0:d.length-1}else{f=0}}this.log("pic idx:"+this.sliderIndex);var e;if(this.isVertical&&(this._opts.animateType=="rotate"||this._opts.animateType=="flip")){if(f>0){e=c.pop();c.unshift(e)}else{if(f<0){e=c.shift();c.push(e)}}}else{if(f>0){e=c.shift();c.push(e)}else{if(f<0){e=c.pop();c.unshift(e)}}}if(f!==0){e.innerHTML=this._renderItem(a+f);e.style.webkitTransition="none";e.style.visibility="hidden";setTimeout(function(){e.style.visibility="visible"},200);this.onslidechange&&this.onslidechange(this.sliderIndex)}for(var b=0;b<3;b++){if(c[b]!==e){c[b].style.webkitTransition="all .3s ease"}this._animateFunc(c[b],this.axis,this.scale,b,0)}if(this.isAutoplay){if(this.sliderIndex===d.length-1&&!this.isLooping){this.pause()}}};iSlider.prototype._bindHandler=function(){var b=this;var d=b.scaleW;var c=b.outer;var a=b.data.length;var g=function(i){isMouseDown=true;b.pause();b.onslidestart&&b.onslidestart();b.log("Event: beforeslide");b.startTime=new Date().getTime();if(!isPC()){b.startX=i.targetTouches[0].pageX;b.startY=i.targetTouches[0].pageY}else{b.startX=i.x;b.startY=i.y}var j=i.target;while(j.nodeName!="LI"&&j.nodeName!="BODY"){j=j.parentNode}b.target=j};var h=function(j){j.preventDefault();if(!isMouseDown){return}b.onslide&&b.onslide();b.log("Event: onslide");var l=b.axis;if(!isPC()){var n=j.targetTouches[0]["page"+l]-b["start"+l]}else{var n=j.x-b["start"+l]}if(!b.isLooping){if(n>0&&b.sliderIndex===0||n<0&&b.sliderIndex===b.data.length-1){n=b._damping(n)}}for(var k=0;k<3;k++){var m=b.els[k];m.style.webkitTransition="all 0s";b._animateFunc(m,l,b.scale,k,n)}b.offset=n};var f=function(i){i.preventDefault();isMouseDown=false;var l=b.scale/2;var k=b.offset;var j=new Date().getTime();l=j-b.startTime>300?l:14;if(k>=l){b._slide(-1)}else{if(k<-l){b._slide(1)}else{b._slide(0)}}b.isAutoplay&&b.play();b.offset=0;b.onslideend&&b.onslideend();b.log("Event: afterslide")};var e=function(i){setTimeout(function(){b.reset();b.log("Event: orientationchange")},100)};c.addEventListener(touchStart,g);c.addEventListener(touchMove,h);if(!isPC()){c.addEventListener(touchEnd,f)}else{document.getElementById("mapCon").addEventListener(touchEnd,f)}window.addEventListener("orientationchange",e)};iSlider.prototype.reset=function(){this.pause();this._setting();this._renderHTML();this.isAutoplay&&this.play()};iSlider.prototype.play=function(){var a=this;var b=this.duration;clearInterval(this.autoPlayTimer);this.autoPlayTimer=setInterval(function(){a._slide(1)},b)};iSlider.prototype.pause=function(){clearInterval(this.autoPlayTimer)};iSlider.prototype.extend=function(b){var a=iSlider.prototype;Object.keys(b).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))})};